const navToggle = document.querySelector('.nav-toggle');
const navMenu = document.querySelector('#nav-menu');
const langButtons = document.querySelectorAll('.lang-btn');
const i18nElements = document.querySelectorAll('[data-i18n]');
const i18nAttrElements = document.querySelectorAll('[data-i18n-attr]');
const heroSlider = document.querySelector('.hero-slider');
const sliderTrack = heroSlider?.querySelector('#hero-slider');
const sliderDots = heroSlider?.querySelector('.slider-dots');
const keyTechList = document.querySelector('#key-tech-list');
const pubFeatured = document.querySelector('#pub-featured');
const teamHighlight = document.querySelector('#team-highlight');

let currentLang = 'zh';
let slidesCache = [];
let keyTechCache = [];
let publicationsCache = [];
let membersCache = [];

const HERO_ROTATE_MS = 6000;
let heroIndex = 0;
let heroTimer = null;

const FALLBACK_SLIDES = [
  {
    id: 's-001',
    tagZh: 'æœ€æ–°å‘å¸?,
    tagEn: 'Latest',
    titleZh: 'ä¸‹ä¸€ä»£è§†è§‰æ™ºèƒ½å¹³å°å‘å¸?,
    titleEn: 'Next-gen Vision Intelligence Platform',
    descriptionZh: 'èåˆå¤§æ¨¡å‹ä¸è§†è§‰ç®—æ³•ï¼Œå…¨é¢æå‡ç§‘ç ”ã€å·¥ä¸šä¸åŸå¸‚åœºæ™¯çš„æ™ºèƒ½æ„ŸçŸ¥èƒ½åŠ›ã€?,
    descriptionEn: 'Integrating foundation models with vision AI to empower cities, industries, and research labs.',
    media: 'image/xreflection.png',
    mediaType: 'image',
    link: 'https://www.sensetime.com/cn/about'
  },
  {
    id: 's-002',
    tagZh: 'å­¦æœ¯åŠ¨æ€?,
    tagEn: 'Research',
    titleZh: 'å¤šæ¨¡æ€è®¤çŸ¥æ¨ç†æ–©è·é¡¶ä¼šè£èª?,
    titleEn: 'Multimodal Reasoning Wins Top-tier Award',
    descriptionZh: 'è§†è§‰ä¸è¯­è¨€èåˆçš„æœ€æ–°çªç ´è£è·æœ€ä½³è®ºæ–‡ï¼Œå±•ç¤ºå¤šæ¨¡æ€è®¤çŸ¥çš„æ–°è¿›å±•ã€?,
    descriptionEn: 'Our multimodal reasoning work earned a best paper award, highlighting breakthroughs in vision-language fusion.',
    media: 'image/modem.png',
    mediaType: 'image',
    link: 'https://www.sensetime.com/cn/news'
  },
  {
    id: 's-003',
    tagZh: 'äº§ä¸šè½åœ°',
    tagEn: 'Solutions',
    titleZh: 'å¤šè¡Œä¸šæ™ºèƒ½è§£å†³æ–¹æ¡?,
    titleEn: 'Industry-ready AI Solutions',
    descriptionZh: 'æ™ºæ…§åŸå¸‚ã€æ™ºèƒ½åˆ¶é€ ä¸åŒ»ç–—å½±åƒç­‰é¢†åŸŸå…¨é¢è½åœ°åˆ›æ–°æ–¹æ¡ˆï¼Œåˆ›é€ çœŸå®ä»·å€¼ã€?,
    descriptionEn: 'Delivering intelligent solutions across smart cities, manufacturing, and healthcare to create real-world impact.',
    media: 'image/modem.mp4',
    mediaType: 'video',
    link: 'https://www.sensetime.com/cn/solutions'
  }
];

const FALLBACK_KEY_TECH = [
  {
    id: 't-001',
    tagZh: 'å¼€æºå·¥å…?,
    tagEn: 'Open Source',
    titleZh: 'XReflection',
    titleEn: 'XReflection',
    descriptionZh: 'é¢å‘å•å¹…å›¾åƒåå°„å»é™¤ï¼ˆSIRRï¼‰çš„é«˜æ•ˆå·¥å…·ç®±ï¼Œè¦†ç›–æ•°æ®æ„å»ºã€è®­ç»ƒä¸æ¨ç†å…¨æµç¨‹ã€?,
    descriptionEn: 'A compact toolbox for single-image reflection removal with end-to-end data, training, and inference pipelines.',
    media: 'image/xreflection.png',
    mediaType: 'image',
    link: 'https://github.com/hainuo-wang/XReflection',
    linkLabelZh: 'è®¿é—®é¡¹ç›® >',
    linkLabelEn: 'Explore Project >'
  },
  {
    id: 't-002',
    tagZh: 'æ——èˆ°æˆæœ',
    tagEn: 'Flagship',
    titleZh: 'MODEMï¼šæç«¯å¤©æ°”å½±åƒæ¢å¤?,
    titleEn: 'MODEM: Extreme-weather Restoration',
    descriptionZh: 'å¼•å…¥ Morton é¡ºåºä¸å¤šå°ºåº¦é€€åŒ–å»ºæ¨¡ï¼Œå®ç°æš´é›¨ã€é›¾éœ¾åœºæ™¯ä¸‹çš„é«˜è´¨é‡å›¾åƒæ¢å¤ã€?,
    descriptionEn: 'Morton-order modelling with multi-scale estimation delivers superior restoration in heavy rain and haze.',
    media: 'image/modem.mp4',
    mediaType: 'video',
    link: 'https://www.sensetime.com/cn/tech',
    linkLabelZh: 'æŸ¥çœ‹è®ºæ–‡ >',
    linkLabelEn: 'Read Paper >'
  }
];

const FALLBACK_PUBLICATIONS = [
  {
    id: 'p-001',
    titleZh: 'MODEMï¼šç”¨äºæ¶åŠ£å¤©æ°”å›¾åƒæ¢å¤çš„ Morton é¡ºåºé€€åŒ–ä¼°è®¡æœºåˆ?,
    titleEn: 'MODEM: A Morton-Order Degradation Estimation Mechanism for Adverse Weather Image Recovery',
    venueZh: 'NeurIPS Â· 2025',
    venueEn: 'NeurIPS Â· 2025',
    authors: 'Hainuo Wang, Qiming Hu, Xiaojie Guo*',
    summaryZh: 'æå‡º Morton é¡ºåºé€€åŒ–å»ºæ¨¡æ¡†æ¶ï¼Œåœ¨æš´é›¨ã€é›¾éœ¾åœºæ™¯ä¸‹å®ç°é«˜è´¨é‡é‡å»ºã€?,
    summaryEn: 'Morton-order degradation modelling achieves high-quality restoration in severe weather conditions.',
    paperUrl: '#',
    codeUrl: '#'
  },
  {
    id: 'p-002',
    titleZh: 'é¢å‘çœŸå®åœºæ™¯æ–‡å­—çš„æ‰©æ•£å¼å›¾åƒè¶…åˆ†è¾¨æ¡†æ?,
    titleEn: 'Text-aware Real-world Image Super-resolution via Diffusion Model with Joint Segmentation Decoders',
    venueZh: 'CVPR Â· 2025',
    venueEn: 'CVPR Â· 2025',
    authors: 'Qiming Hu, Linglong Fan, Yiyan Luo, Yuhang Yu, Qingnan Fan, Xiaojie Guo*',
    summaryZh: 'è”åˆåˆ†å‰²è§£ç å™¨ä¿æŒçœŸå®åœºæ™¯æ–‡å­—ç»†èŠ‚ï¼Œæ˜¾è‘—æå‡å¯è¯»æ€§ã€?,
    summaryEn: 'Joint decoders preserve text fidelity in real-world scenarios.',
    paperUrl: '#',
    codeUrl: '#'
  }
];

const FALLBACK_MEMBERS = [
  {
    id: 'm-001',
    nameZh: 'æè€å¸ˆ',
    nameEn: 'Professor Li',
    roleZh: 'å¯¼å¸ˆ',
    roleEn: 'Supervisor',
    group: 'teacher',
    avatar: ''
  },
  {
    id: 'm-002',
    nameZh: 'å¼ ä¸‰',
    nameEn: 'Zhang San',
    roleZh: 'åšå£«ç ”ç©¶ç”?,
    roleEn: 'PhD Student',
    group: 'phd',
    avatar: ''
  }
];

const translations = {
  zh: {
    siteNameZh: 'æœªæ¥æ™ºèƒ½å®éªŒå®?,
    siteNameEn: 'Future Intelligence Lab',
    navAriaLabel: 'ä¸»å¯¼èˆ?,
    langSwitchLabel: 'è¯­è¨€åˆ‡æ¢',
    langChinese: 'ä¸­æ–‡',
    langEnglish: 'EN',
    navHome: 'é¦–é¡µ',
    navResearch: 'ç ”ç©¶æ–¹å‘',
    navKeyTech: 'ç§‘ç ”æˆæœ',
    navTeam: 'å›¢é˜Ÿæˆå‘˜',
    navPublications: 'å‡ºç‰ˆç‰?,
    navJoin: 'åŠ å…¥æˆ‘ä»¬',
    navContact: 'è”ç³»æ–¹å¼',
    heroEyebrow: 'æ¢ç´¢ç§‘å­¦å‰æ²¿ Â· é©±åŠ¨æœªæ¥æ™ºèƒ½',
    heroHeadline: 'Stay&nbsp;Simple&nbsp;&#8226;&nbsp;Stay&nbsp;Diverse',
    heroIntro: 'æœªæ¥æ™ºèƒ½å®éªŒå®¤èšç„¦è§†è§‰æ™ºèƒ½ã€è®¤çŸ¥è®¡ç®—ä¸å¤šæ¨¡æ€?AIï¼Œæ‰“é€ ä»åŸºç¡€ç†è®ºåˆ°äº§ä¸šè½åœ°çš„å…¨é“¾æ¡åˆ›æ–°å¹³å°ã€?,
    heroCTAResearch: 'æ¢ç´¢ç ”ç©¶æ–¹å‘',
    heroCTAJoin: 'åŠ å…¥æˆ‘ä»¬',
    heroStatPapers: 'å­¦æœ¯è®ºæ–‡ (Top-tier)',
    heroStatPatents: 'æˆæƒå‘æ˜ä¸“åˆ©',
    heroStatPartners: 'å›½é™…åˆä½œä¼™ä¼´',
    researchHeading: 'æ ¸å¿ƒç ”ç©¶æ–¹å‘',
    researchSubheading: 'å›´ç»•äººå·¥æ™ºèƒ½ä¸è®¡ç®—æœºè§†è§‰çš„å…³é”®è®®é¢˜ï¼Œå¸ƒå±€æœªæ¥åå¹´çš„æŠ€æœ¯çªç ´å£ã€?,
    researchCard1Title: 'åå°„å»é™¤ä¸å±‚æé‡å»?,
    researchCard1Desc: 'å›´ç»•å•å¹…å›¾åƒåå°„å»é™¤ï¼ˆSIRRï¼‰ä¸åœºæ™¯åˆ†å±‚ï¼Œæ‰“é€?XReflection ç­‰é«˜æ•ˆå·¥å…·é“¾ï¼Œå®ç°çœŸå®åœºæ™¯çš„æ¸…æ™°é‡å»ºã€?,
    researchCard2Title: 'æç«¯æ¡ä»¶ä¸‹çš„å›¾åƒå¢å¼º',
    researchCard2Desc: 'ç ”ç©¶æ¶åŠ£å¤©æ°”ä¸ä½å…‰ç…§é€€åŒ–å»ºæ¨¡ï¼Œå¼€å?MODEM ç­‰è§†è§‰æ¢å¤æ–¹æ³•ï¼Œæå‡å¤æ‚ç¯å¢ƒä¸­çš„æˆåƒè´¨é‡ã€?,
    researchCard3Title: 'æ–‡æœ¬æ„ŸçŸ¥è¶…åˆ†ä¸ç”Ÿæˆ?,
    researchCard3Desc: 'ä»¥æ‰©æ•£æ¨¡å‹å’Œè”åˆè§£ç å™¨ä¸ºæ ¸å¿ƒï¼Œæ„å»ºçœŸå®åœºæ™¯æ–‡æœ¬åŒºåŸŸçš„é«˜ä¿çœŸç”Ÿæˆèƒ½åŠ›ã€?,
    researchCard4Title: 'é²æ£’è§†é¢‘ç†è§£ä¸è·¨åŸŸæ„ŸçŸ?,
    researchCard4Desc: 'èšç„¦é«˜æ•ˆè§†é¢‘ç›®æ ‡æ£€æµ‹ä¸å·®å¼‚åŒ–å¯¹é½ç­–ç•¥ï¼Œæå‡è·¨åœºæ™¯çš„æ•°æ®æ³›åŒ–ä¸å®æ—¶æ„ŸçŸ¥èƒ½åŠ›ã€?,
    researchLearnMore: 'äº†è§£è¯¦æƒ…',
    keyTechHeading: 'å…³é”®æŠ€æœ¯ä¸ä»£è¡¨æ€§æˆæ?,
    keyTechSubheading: 'ä»åŸåˆ›ç®—æ³•åˆ°äº§ä¸šçº§ç³»ç»Ÿï¼ŒæŒç»­è¾“å‡ºé«˜å½±å“åŠ›çš„ç§‘ç ”æˆæœã€?,
    pubsHeading: 'ç²¾é€‰å‡ºç‰ˆç‰©',
    pubsSubheading: 'èšç„¦é¡¶çº§ä¼šè®®ä¸æœŸåˆŠçš„æœ€æ–°æˆæœï¼Œå±•ç°æˆ‘ä»¬åœ¨è§†è§‰æ™ºèƒ½ä¸å¤šæ¨¡æ€?AI é¢†åŸŸçš„æŒç»­çªç ´ã€?,
    pubsCTA: 'æŸ¥çœ‹å…¨éƒ¨å‡ºç‰ˆç‰?,
    emptyFeatured: 'æš‚æ— ç²¾é€‰å‡ºç‰ˆç‰©ã€?,
    emptyTech: 'æš‚æ— å…³é”®æŠ€æœ¯æ¡ç›®ã€?,
    emptyMembers: 'æš‚æ— å›¢é˜Ÿæˆå‘˜ã€?,
    joinHeading: 'ä¸æˆ‘ä»¬ä¸€èµ·æ¢ç´¢æœªæ¥æ™ºèƒ?,
    joinDescription: 'æˆ‘ä»¬æ­£åœ¨å¯»æ‰¾å¯¹äººå·¥æ™ºèƒ½ã€è®¡ç®—æœºè§†è§‰ä¸è·¨å­¦ç§‘åˆ›æ–°å……æ»¡çƒ­æƒ…çš„ç ”ç©¶è€…ä¸å·¥ç¨‹å¸ˆã€‚åŠ å…¥æˆ‘ä»¬ï¼Œä¸€èµ·çªç ´æŠ€æœ¯è¾¹ç•Œã€?,
    joinCTA: 'ç«‹å³æŠ•é€’ç®€å?,
    footerContactTitle: 'è”ç³»æˆ‘ä»¬',
    footerAddressLabel: 'åœ°å€ï¼?,
    footerAddressText: 'ä¸­å›½åŒ—äº¬å¸‚æµ·æ·€åŒºå­¦åºœå¤§è¡?88 å·æœªæ¥ç§‘æŠ€å›?B åº?,
    footerPhoneLabel: 'ç”µè¯ï¼?,
    footerPhoneText: '+86 10 1234 5678',
    footerEmailLabel: 'é‚®ç®±ï¼?,
    footerEmailText: 'contact@futurelab.ai',
    footerLinksTitle: 'å¿«é€Ÿé“¾æ?,
    footerFollowTitle: 'å…³æ³¨æˆ‘ä»¬',
    footerSocialGithub: 'GitHub',
    footerSocialLinkedIn: 'LinkedIn',
    footerSocialTwitter: 'Twitter',
    footerPartnersLabel: 'åˆä½œä¼™ä¼´ï¼?,
    footerCopyright: 'Â© 2024 æœªæ¥æ™ºèƒ½å®éªŒå®?Â· ç‰ˆæƒæ‰€æœ?| äº¬ICPå¤?12345678 å?
  },
  en: {
    siteNameZh: 'Future Intelligence Lab',
    siteNameEn: 'Future Intelligence Lab',
    navAriaLabel: 'Main navigation',
    langSwitchLabel: 'Language toggle',
